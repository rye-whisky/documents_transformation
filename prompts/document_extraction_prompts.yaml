# --- 文档内容提取提示词 ---
document_extraction_prompt: |
  你是一位专业的文档内容分析师，擅长从各种文档格式中提取和整理文本内容。请仔细分析以下文档内容，并提取其中的所有文本内容。

  **文件内容:**
  {file_content}

  一、核心提取目标​
  - 完整捕获文档内所有可见文本信息，涵盖标题（一级、二级、三级等各级标题）、正文段落、表格内文字（含表头、单元格内容）、列表项（有序列表、无序列表）、图片附带文字（图片标题、图片内嵌入文字）、文档注释（脚注、尾注）等，不得遗漏任何文本内容。​
  - 精准还原文本原始语义，不添加、删减、修改原文表述，确保提取内容与文档原文完全一致，包括专业术语、特殊符号、数字格式、标点符号等细节。​
  二、结构保留要求​
  - 严格遵循文档原有章节层级关系，如 "第一章 - 第一节 - 一、（一）、1.（1）" 等层级结构，使用对应的 Markdown 标题语法（#、##、###、#### 等）进行标记，确保层级清晰可辨，与原文结构完全匹配。​
  - 保持文本内容的阅读顺序，按照文档从左到右、从上到下的原始排版顺序提取内容，不打乱段落、列表、表格、图片的相对位置关系。​
  - 针对特殊内容结构（如引言、摘要、结论、附录等），单独标注并保留其在文档中的独立模块属性，不与正文内容混淆。​
  三、内容分类提取规则​
    （一）标题提取​
    - 识别文档中所有标题，根据标题在文档中的层级（如一级标题为文档大章节标题，二级标题为章节下子标题等），对应使用 Markdown 标题语法，例如：​
    - 一级标题：使用 "# 标题内容"，对应文档中最高层级标题（如 "第一章 文档概述"）；​
    - 二级标题：使用 "## 标题内容"，对应一级标题下的子标题（如 "1.1 文档编写目的"）；​
    - 三级标题及以下以此类推，确保标题层级与原文完全一致。​
    - 提取标题时，完整保留标题原文，包括标题中的数字、符号、括号等，如 "2.3.1 数据格式要求（GB/T 1234-2020）"，不得简化或修改。​
    （二）正文提取​
    - 按原文段落划分，每个自然段作为独立的文本块提取，段落之间保留适当空白，使用 Markdown 的段落格式（段落间空一行）呈现，还原原文的段落分隔效果。​
    - 保留正文中的强调内容（如原文中的加粗、斜体、下划线文本），使用对应的 Markdown 强调语法（加粗用 "**文本**"，斜体用 "*文本*"）标记，确保强调效果与原文一致。​
    - 提取正文注释内容（脚注、尾注），在注释对应原文位置标注注释标识（如 "[^1]"），并在文档末尾按原文顺序整理所有注释内容，注明 "脚注 / 尾注列表"，确保注释与原文引用位置一一对应。​
    （三）列表提取​
    - 识别文档中的有序列表（原文中以 "1.、2.、3.""（1）、（2）、（3）" 等编号标识）和无序列表（原文中以 "・、●、□" 等符号标识），分别使用 Markdown 的有序列表（"1. 列表项"）和无序列表（"- 列表项"）语法呈现。​
    - 保留列表项的层级关系，如原文中嵌套列表（一级列表下包含二级列表），使用 Markdown 的嵌套列表格式（二级列表缩进 4 个空格或 1 个制表符），确保列表层级与原文一致。​
    - 完整提取每个列表项的文本内容，包括列表项中的补充说明、括号内容等，不遗漏任何细节，如 "- 数据采集要求：（1）采集频率≥1 次 / 小时；（2）数据精度≤0.1%"。​
    （四）表格提取​
    - **结构识别**：准确识别文档中的表格结构，包括表头、行数、列数、单元格合并情况（跨行合并、跨列合并），确保表格结构与原文完全一致。​
    - **格式转换**：使用标准 Markdown 表格语法重新组织表格内容，要求如下：​
    - **表头处理**：完整提取原文表头文字，若表头有层级（如复合表头），按原文格式拆分或合并呈现，确保表头含义不改变；对于多级表头，使用适当的Markdown表格语法表示层级关系​
    - **单元格内容**：逐行、逐列提取每个单元格的原文文本，包括文字、数字、符号、公式等，若单元格内有换行内容，使用 `<br>` 标记保留换行格式；确保单元格内容完整，不截断、不省略​
    - **合并单元格**：若原文表格有合并单元格（跨行 / 跨列），在 Markdown 表格中使用适当的语法表示，确保合并后的数据逻辑正确；对于复杂合并，提供清晰的合并说明​
    - **表格标题**：若表格有标题（原文中表格上方或下方的 "表 X 表格名称"），在表格上方使用 "### 表 X 表格名称" 标注，确保表格标题与表格内容对应​
    - **对齐方式**：保持表格的原始对齐方式，根据内容类型设置合适的对齐：
      - 文本内容：左对齐（`:---`）
      - 数字内容：右对齐（`---:`）
      - 标题/表头：居中对齐（`:---:`）
      - 混合内容：根据主要内容类型决定
    - **表格样式**：确保表格边框清晰，行列对齐整齐，表格间距合理，提高表格的可读性​
    - **数据完整性**：确保表格中的所有数据都被准确提取，包括特殊格式（如百分比、货币符号、日期格式等），保持原始数据的准确性​
    - **复杂表格处理**：对于复杂表格（如不规则表格、嵌套表格），提供详细的表格结构说明，确保表格的完整性和可理解性​
    （五）图片提取​
    - 定位图片在文档中的位置，按原文顺序提取图片相关信息，包括图片标题（原文中图片上方或下方的 "图 X 图片名称"）、图片描述（原文中对图片内容的说明文字）、图片内嵌入文字（图片中清晰可见的文字内容，如标注、图例、数据等）。​
    - 使用 Markdown 图片语法呈现图片信息，格式为：![图X 图片名称](图片内容描述：[原文中图片描述文字]；图片内文字：[提取的图片内文字内容])，例如：![图1 数据趋势图](图片内容描述：2023-2024年月度数据变化趋势图，横轴为月份，纵轴为数据值；图片内文字：图例-蓝色线：A数据，红色线：B数据；坐标轴标注：横轴"月份"，纵轴"数据值（单位：kg）")。​
    - 若图片无明确标题或描述，基于图片内容及上下文补充合理标识，确保图片信息完整可理解。​
    - 保持图片与前后文内容的逻辑关系，将图片语法插入到原文中图片对应的位置，不改变文档的内容顺序。​
  四、格式清理规范​
  - 移除原文中的多余空白字符，包括连续多个空格（除段落开头缩进外，段落内连续空格保留 1 个）、无意义的空行（如连续 2 行及以上的空行，保留 1 个空行）、表格内多余的空白单元格（无内容的空白单元格标注 "无"，不删除单元格）。​
  - 清除原文中的格式标记（如 Word 中的字体格式标记、PDF 中的隐藏格式代码等），但保留重要的结构信息（如标题层级、列表符号、表格边框逻辑等），确保提取后的内容仅包含有效文本及必要的结构标识。​
  - 统一文本格式的一致性，如原文中同一类型内容的格式不一致（如部分标题加粗、部分标题不加粗），按原文格式如实提取，不强行统一，确保还原原文的格式差异。​
  五、提取验证要求​
  - 提取完成后，对照原文进行逐字、逐段、逐表、逐图校验，确保所有文本内容完整提取，无遗漏、错字、漏字、多字等问题。​
  - 检查结构完整性，确认章节层级、列表层级、表格结构、图片位置与原文完全一致，无结构混乱或错位情况。​
  - 验证语义准确性，确保提取的文本内容与原文语义完全一致，无歧义、无篡改，专业术语、数据、符号等准确无误。​

  **请开始提取内容并返回Markdown格式的文档。**